## 题目描述

有一个 $(n−1)\times(m−1)$ 的长方形网格图，其中放置了一些火柴。每根火柴恰好放置在一个小正方形格子的边上或对角线上（你可以认为火柴能屈能伸，放在边上长度就是 1，放在对角线上长度就能变成 $2-\sqrt 2$）。任何两根火柴不在非端点的位置相交。保证如果把这些火柴看成边，它们和 $n\times m$个格点会构成一张连通图。

你现在要选择一根火柴，把它移动到其它位置（由于火柴能屈能伸，把边上的火柴移到对角线上或反之都是合法的）。你需要保证移动后依然满足上面的条件，即任何两根火柴不在非端点的位置相交，且如果把这些火柴看成边，它们和 $n\times m$ 个格点会构成一张连通图。求合法的移动方案数。两种方案不同当且仅当移动前火柴的位置不同或移动后火柴的位置不同。

## 输入格式

第一行，两个正整数 $n,m$ 。

接下来 $n$ 行，每行一个长为 $m$ 的字符串，第 $i$ 行第 $j$ 列的字符为一个 16 进制数码。把这个数码看成一个4位二进制数，每一位分别指示：

- $2^0$ 位：第 $i$ 行第 $j$ 列的格点与它右上角的格点有无火柴相连。
- $2^1$ 位：第 $i$ 行第 $j$ 列的格点与它右方的格点有无火柴相连。
- $2^2$ 位：第 $i$ 行第 $j$ 列的格点与它右下角的格点有无火柴相连。
- $2^3$ 位：第 $i$ 行第 $j$ 列的格点与它下方的格点有无火柴相连。

保证所有火柴都在网格内部，不在非格点处相交，且能连通所有格点。

## 输出格式

输出一个整数，代表移动火柴的方案数。

---

```
2 2
20
30
```

```
5
```

样例解释见：解释.jpg

---

```
3 2
88
88
20
```

```
20
```

---

```
3 3
8E8
FA8
220
```

```
43
```

---

4:见文件

---

$1\le n,m\le 700$

